<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Server Tools Collection</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* ========== EXACT COLORS FROM INDEX(9).HTML ========== */
        :root {
            --primary: #3a56d4;
            --primary-light: #5a72e0;
            --primary-dark: #2a46c4;
            --secondary: #6c757d;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
            --info: #17a2b8;
            --light: #f8f9fa;
            --dark: #212529;
            --border-radius: 8px;
            --transition: all 0.2s ease;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: #f5f7fa;
            min-height: 100vh;
            padding: 0;
            color: var(--dark);
        }

        /* Dashboard Header - exactly like index(9) */
        .dashboard-header {
            background: linear-gradient(135deg, #2a46c4, #3a56d4);
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        @media (min-width: 768px) {
            .header-content {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
        }

        .header-left h1 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .header-left .subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .tool-selector {
            display: flex;
            gap: 5px;
            background: rgba(255, 255, 255, 0.1);
            padding: 5px;
            border-radius: var(--border-radius);
            overflow-x: auto;
        }

        .tool-tab {
            padding: 8px 16px;
            border: none;
            background: transparent;
            color: rgba(255, 255, 255, 0.8);
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
            flex: 1;
            justify-content: center;
            min-width: 140px;
        }

        .tool-tab:hover {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .tool-tab.active {
            background: white;
            color: #3a56d4;
        }

        /* Main Container */
        .dashboard-container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 0 20px;
        }

        .tool-section {
            display: none;
        }

        .tool-section.active {
            display: block;
        }

        /* Card Styles - matching index(9) exactly */
        .card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #eaeaea;
        }

        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eaeaea;
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-title i {
            color: #3a56d4;
        }

        .badge {
            background: #3a56d4;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Form Elements */
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #cbd5e1;
            border-radius: var(--border-radius);
            font-family: 'Consolas', monospace;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 15px;
            background: #f8fafc;
        }

        textarea:focus {
            outline: none;
            border-color: #3a56d4;
            box-shadow: 0 0 0 2px rgba(58, 86, 212, 0.1);
        }

        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-outline {
            background: white;
            border: 1px solid #cbd5e1;
            color: #64748b;
        }

        .btn-outline:hover {
            background: #f1f5f9;
            color: #1e293b;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 0.8rem;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
            justify-content: space-between;
        }

        .left-buttons, .right-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Stats Cards - bright gradient like your file */
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .summary-card {
            background: linear-gradient(135deg, #3a56d4, #2a46c4);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11), 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        .summary-card .label {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .summary-card .value {
            font-size: 2rem;
            font-weight: bold;
        }

        /* Error Tabs */
        .error-type-selector {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #eaeaea;
        }

        .error-type-tabs {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .error-tab {
            padding: 8px 16px;
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
            color: #495057;
        }

        .error-tab:hover {
            background: #e9ecef;
        }

        .error-tab.active {
            background: #3a56d4;
            color: white;
            border-color: #3a56d4;
        }

        .error-tab .count {
            background: rgba(58, 86, 212, 0.1);
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .error-tab.active .count {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .error-content {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .error-stats {
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 1px solid #dee2e6;
        }

        .error-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .error-stat-item {
            text-align: center;
        }

        .error-stat-label {
            color: #6c757d;
            font-size: 0.9em;
            margin-bottom: 5px;
        }

        .error-stat-value {
            color: #495057;
            font-size: 1.5em;
            font-weight: bold;
        }

        .ip-list {
            padding: 20px;
            max-height: 400px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .ip-list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: white;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
            border-radius: 6px 6px 0 0;
        }

        .copy-ips-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .copy-ips-btn:hover {
            background: #218838;
        }

        .ip-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #dee2e6;
            font-family: 'Consolas', monospace;
            background: white;
        }

        .ip-item:last-child {
            border-bottom: none;
        }

        .ip-address {
            flex: 1;
            font-weight: 600;
            color: #495057;
        }

        .ip-teams {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .team-badge {
            background: #3a56d4;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.7rem;
        }

        .detected-errors-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .error-count-badge {
            background: #3a56d4;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        /* IP Explorer Styles - bright and clean */
        .ip-index-bar {
            background: #f2f7fd;
            border-radius: 48px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
            border: 1px solid #dae2ed;
        }

        .ip-pills {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            flex: 1;
        }

        .ip-pill {
            background: white;
            border: 1px solid #b5ceea;
            padding: 6px 14px;
            border-radius: 60px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #103457;
            transition: all 0.2s;
        }

        .ip-pill:hover {
            background: #1f4d86;
            color: white;
            border-color: #1f4d86;
        }

        .ip-pill.active {
            background: #1f4d86;
            color: white;
            border-color: #1f4d86;
        }

        .ip-pill .server-count {
            background: #dae5f2;
            padding: 2px 8px;
            border-radius: 30px;
            font-size: 0.7rem;
            color: #132e4a;
        }

        .ip-pill.active .server-count {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .reset-pill {
            background: #e1e9f3;
            border: 1px solid #9cb9d8;
            color: #1e3c5a;
            padding: 6px 14px;
            border-radius: 60px;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .reset-pill:hover {
            background: #d1dfee;
        }

        .stats-line {
            margin: 15px 0;
            color: #345579;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .masonry-grid {
            column-count: 2;
            column-gap: 20px;
        }

        @media (max-width: 768px) {
            .masonry-grid {
                column-count: 1;
            }
        }

        .block-card {
            background: white;
            border-radius: 28px;
            padding: 20px;
            box-shadow: 0 8px 20px rgba(0, 20, 40, 0.06);
            break-inside: avoid;
            margin-bottom: 20px;
            border-left: 6px solid #2b6c9e;
            border: 1px solid #dae2ed;
        }

        .timestamp-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #e9f0fa;
            padding: 8px 16px;
            border-radius: 60px;
            margin-bottom: 15px;
            border: 1px solid #c4d5ec;
        }

        .timestamp-badge {
            background: #2d4b6e;
            color: white;
            padding: 4px 12px;
            border-radius: 40px;
            font-size: 0.8rem;
        }

        .server-count-badge {
            background: white;
            color: #1f4770;
            padding: 4px 12px;
            border-radius: 40px;
            font-size: 0.8rem;
            border: 1px solid #aac3e6;
        }

        .byip-value {
            font-size: 2rem;
            font-weight: 700;
            color: #0f3b60;
            background: #e9f0fa;
            padding: 4px 16px;
            border-radius: 60px;
            display: inline-block;
            border: 1px solid #c1d3ec;
        }

        .servers-in-card {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
            margin-top: 15px;
            padding: 16px;
            background: #f8fbfe;
            border-radius: 24px;
        }

        .server-chip {
            background: white;
            padding: 6px 16px;
            border-radius: 60px;
            font-family: monospace;
            font-size: 0.9rem;
            border: 1px solid #c4d5ec;
            color: #123456;
            box-shadow: 0 2px 6px rgba(0,0,0,0.02);
        }

        .copy-btn {
            background: #4a6f8f;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 40px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: auto;
            border: 1px solid #6b8eb0;
        }

        .copy-btn:hover {
            background: #345779;
        }

        .placeholder-nodata {
            background: #f1f7ff;
            border-radius: 48px;
            padding: 48px 32px;
            text-align: center;
            color: #3e6082;
            border: 2px dashed #bbd2f0;
            grid-column: span 2;
        }

        /* Server Performance Styles - bright like your file */
        .filter-section {
            background: white;
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
            border: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-left {
            display: flex;
            align-items: center;
            gap: 25px;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-label {
            color: #64748b;
            font-size: 13px;
            font-weight: 500;
        }

        .filter-btn {
            padding: 4px 12px;
            border: 1px solid #cbd5e1;
            border-radius: 30px;
            background: white;
            color: #1e293b;
            font-size: 12px;
            cursor: pointer;
        }

        .filter-btn:hover {
            background: #f1f5f9;
        }

        .filter-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .ip-filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
            flex-wrap: wrap;
            padding-left: 15px;
            border-left: 2px solid #e2e8f0;
        }

        .ip-filter-btn {
            padding: 4px 10px;
            border: 1px solid #f59e0b;
            border-radius: 30px;
            background: #fffbeb;
            color: #b45309;
            font-size: 12px;
            cursor: pointer;
        }

        .ip-filter-btn.active {
            background: #f59e0b;
            color: white;
            border-color: #f59e0b;
        }

        .blocks-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .data-block {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .block-header {
            background: #f8fafc;
            padding: 12px 20px;
            border-bottom: 2px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .time-badge {
            background: #3b82f6;
            color: white;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 12px;
        }

        .ip-badge {
            background: #f59e0b;
            color: white;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 12px;
            font-weight: 600;
        }

        .servers-grid {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }

        .server-card {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            border-left: 4px solid;
        }

        .server-card.excellent {
            border-left-color: #10b981;
        }

        .server-card.good {
            border-left-color: #3b82f6;
        }

        .server-card.warning {
            border-left-color: #f59e0b;
        }

        .server-card.bad {
            border-left-color: #ef4444;
        }

        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .server-name {
            font-weight: 600;
            color: #1e293b;
            font-size: 14px;
        }

        .server-status {
            font-size: 10px;
            font-weight: 600;
            padding: 2px 8px;
            border-radius: 20px;
        }

        .server-status.excellent {
            background: #d1fae5;
            color: #065f46;
        }

        .server-status.good {
            background: #dbeafe;
            color: #1e40af;
        }

        .server-status.warning {
            background: #fef3c7;
            color: #92400e;
        }

        .server-status.bad {
            background: #fee2e2;
            color: #991b1b;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            background: white;
            padding: 8px 10px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            margin: 10px 0;
        }

        .target-box .label, .sent-box .label {
            color: #64748b;
            font-size: 9px;
            text-transform: uppercase;
        }

        .target-box .value {
            font-weight: 700;
            font-size: 14px;
            color: #1e293b;
        }

        .sent-box .value {
            font-weight: 700;
            font-size: 14px;
        }

        .sent-box .value.excellent {
            color: #10b981;
        }

        .sent-box .value.good {
            color: #3b82f6;
        }

        .sent-box .value.warning {
            color: #f59e0b;
        }

        .sent-box .value.bad {
            color: #ef4444;
        }

        .progress-bar {
            height: 6px;
            background: #e2e8f0;
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
        }

        .progress-fill.excellent {
            background: #10b981;
        }

        .progress-fill.good {
            background: #3b82f6;
        }

        .progress-fill.warning {
            background: #f59e0b;
        }

        .progress-fill.bad {
            background: #ef4444;
        }

        .percentage {
            font-size: 11px;
            color: #64748b;
            text-align: right;
        }

        .hidden {
            display: none;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            background: white;
            border-radius: 12px;
            color: #64748b;
            border: 1px solid #e2e8f0;
        }

        .loading {
            text-align: center;
            padding: 50px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3a56d4;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .toast-message {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: #3a56d4;
            color: white;
            padding: 12px 24px;
            border-radius: 40px;
            font-weight: 500;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
</head>
<body>
    <!-- Dashboard Header - exactly like index(9) -->
    <div class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <h1>Server Tools Dashboard</h1>
                <p class="subtitle">Server Performance ¬∑ IP Explorer ¬∑ Email Error Parser</p>
            </div>
            <div class="tool-selector">
                <!-- Tabs in your requested order: Server Performance, IP Explorer, Email Error Parser -->
                <button class="tool-tab active" onclick="switchTab(0)">üìä Server Performance</button>
                <button class="tool-tab" onclick="switchTab(1)">üåê By IP Explorer</button>
                <button class="tool-tab" onclick="switchTab(2)">üìß Email Error Parser</button>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="dashboard-container">
        <!-- Tab 0: Server Performance Analyzer (first tab) -->
        <div id="tab0" class="tool-section active">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-chart-line"></i> Server Performance Analyzer</h2>
                </div>
                
                <textarea id="inputData">TEAM: C
16/02 20:35:13    
Profile = √óCMH6_list_warmup_All_30
üìß Mailer üìß: Hanae HAJ M HAND
$ üìä Total Out: 114678
üí• s_cmh6_5918: Server Down 0
üü¢ s_cmh6_5930: 10244 10244
üü¢ s_cmh6_5935: 17245 17969
üü¢ s_cmh6_5937: 10486 10486
üü¢ s_cmh6_5938: 5001 5000
üü¢ s_cmh6_5945: 15245 15245
üü¢ s_cmh6_5946: 20246 20246
üü¢ s_cmh6_5947: 20246 20246
üü¢ s_cmh6_5948: 15245 15242

‚ùóÔ∏èErrors ‚ùóÔ∏è:
5.135.213.226
5.135.213.228
5.135.213.225
5.135.213.224
 ‚ö†Ô∏è Other
Total IPs: 24
Servers: 8
Limit: 120000
By Server: 15000.00
By IP: 5000.00
------

TEAM: C
16/02 18:24:17    
Profile = √óCMH6_list_warmup_All_30
üìß Mailer üìß: Hanae HAJ M HAND
$ üìä Total Out: 47010
üü¢ s_cmh6_5954: 1253 1253
üü¢ s_cmh6_5955: 5257 4216
üü¢ s_cmh6_5957: 4251 4256
üü¢ s_cmh6_5962: 29784 29784
üü¢ s_cmh6_5966: 3250 3250
üü¢ s_cmh6_5968: 4251 4251

‚ùóÔ∏èErrors ‚ùóÔ∏è:
104.206.37.68
 ‚ö†Ô∏è Rate limit SPF
Total IPs: 46
Servers: 6
Limit: 46000
By Server: 7666.67
By IP: 1000.00</textarea>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="parseData()"><i class="fas fa-play"></i> Parse Data</button>
                    <button class="btn btn-outline" onclick="resetFilters()"><i class="fas fa-undo"></i> Reset Filters</button>
                </div>
            </div>

            <div id="results" class="hidden">
                <div class="filter-section" id="filterSection"></div>
                <div id="blocksContainer" class="blocks-container"></div>
            </div>
        </div>

        <!-- Tab 1: By IP Explorer (second tab) -->
        <div id="tab1" class="tool-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-globe"></i> By IP Explorer</h2>
                    <span class="badge" id="blockCount">0 blocks</span>
                </div>
                
                <textarea id="rawInput" placeholder="Paste your message send bot logs‚Ä¶"></textarea>
            </div>

            <div class="ip-index-bar">
                <span class="card-title" style="margin:0;"><i class="fas fa-filter"></i> by IP values</span>
                <div class="ip-pills" id="ipPillsContainer"></div>
                <div class="reset-pill" id="resetSelection">show all</div>
            </div>

            <div class="stats-line">
                <span id="selectedIpLabel">üåê all groups</span> ¬∑ <span id="serverCountDisplay">0 servers</span>
                <div>
                    <button class="btn btn-outline btn-sm" id="fullResetBtn" title="Reset everything to default">
                        <i class="fas fa-trash"></i> full reset
                    </button>
                    <button class="btn btn-outline btn-sm" id="downloadTableBtn" title="Download filtered data as CSV">
                        <i class="fas fa-download"></i> download CSV
                    </button>
                </div>
            </div>

            <div id="resultsContainer" class="masonry-grid">
                <div class="placeholder-nodata">üëÜ paste data, then click any IP pill</div>
            </div>
        </div>

        <!-- Tab 2: Email Error Parser (third tab) -->
        <div id="tab2" class="tool-section">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title"><i class="fas fa-envelope"></i> Email Error Parser</h2>
                    <p>Click on any error type to see its IPs</p>
                </div>
                
                <textarea id="inputText" placeholder="Paste your error log here..."></textarea>
                
                <div class="button-group">
                    <div class="left-buttons">
                        <button class="btn btn-primary" onclick="parseErrors()">
                            <i class="fas fa-play"></i> Parse Errors
                        </button>
                    </div>
                    <div class="right-buttons">
                        <button class="btn btn-danger" onclick="fullReset()">
                            <i class="fas fa-trash"></i> Reset Everything
                        </button>
                    </div>
                </div>
            </div>

            <!-- Summary Cards -->
            <div id="summaryCards" class="summary-cards" style="display: none;"></div>

            <!-- Detected Errors Section -->
            <div id="errorSelector" class="error-type-selector" style="display: none;">
                <div class="detected-errors-title">
                    <h3><i class="fas fa-tags"></i> Detected Errors</h3>
                    <span id="errorCount" class="error-count-badge">0 errors</span>
                </div>
                
                <div id="errorTabs" class="error-type-tabs"></div>

                <div id="errorContent" class="error-content" style="display: none;"></div>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Parsing error data...</p>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <!-- Original JavaScript (completely unchanged) -->
    <script>
        // ==================== TAB SWITCHING ====================
        function switchTab(index) {
            document.querySelectorAll('.tool-tab').forEach((btn, i) => {
                if (i === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            
            document.querySelectorAll('.tool-section').forEach((section, i) => {
                if (i === index) section.classList.add('active');
                else section.classList.remove('active');
            });
        }

        // ==================== TOAST NOTIFICATION ====================
        function showToast(message, duration = 2000, isError = false) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast-message';
            toast.style.background = isError ? '#dc3545' : '#3a56d4';
            toast.textContent = message;
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, duration);
        }

        // ==================== TOOL 1: SERVER PERFORMANCE ANALYZER (ORIGINAL CODE) ====================
        let blocks = [];
        let originalInput = '';
        let currentStatusFilter = 'all';
        let currentIPFilter = 'all';

        function parseData() {
            const text = document.getElementById('inputData').value;
            originalInput = text;
            const rawBlocks = text.split('------').filter(b => b.trim());
            
            blocks = rawBlocks.map(block => {
                const lines = block.split('\n');
                const blockData = {
                    datetime: '',
                    byIP: 0,
                    servers: [],
                    rawText: block.trim()
                };

                lines.forEach(line => {
                    line = line.trim();
                    
                    if (line.match(/\d{2}\/\d{2}\s+\d{2}:\d{2}:\d{2}/)) {
                        blockData.datetime = line;
                    }
                    
                    if (line.includes('By IP:')) {
                        const match = line.match(/[\d,.]+/);
                        if (match) {
                            blockData.byIP = parseFloat(match[0].replace(/,/g, ''));
                        }
                    }
                    
                    if (line.startsWith('üü¢')) {
                        const match = line.match(/üü¢\s+([^:]+):\s+(\d+)\s+(\d+)/);
                        if (match) {
                            const target = parseInt(match[2]);
                            const sent = parseInt(match[3]);
                            const percentage = (sent / target * 100);
                            
                            let status = '';
                            if (percentage >= 100) status = 'excellent';
                            else if (percentage >= 70) status = 'good';
                            else if (percentage >= 60) status = 'warning';
                            else status = 'bad';
                            
                            blockData.servers.push({
                                name: match[1].trim(),
                                target: target,
                                sent: sent,
                                percentage: percentage,
                                status: status,
                                byIP: blockData.byIP,
                                raw: line
                            });
                        }
                    }
                    
                    if (line.startsWith('üí•')) {
                        const match = line.match(/üí•\s+([^:]+)/);
                        if (match) {
                            blockData.servers.push({
                                name: match[1].trim(),
                                target: 0,
                                sent: 0,
                                percentage: 0,
                                status: 'bad',
                                isDown: true,
                                byIP: blockData.byIP,
                                raw: line
                            });
                        }
                    }
                });
                
                return blockData;
            }).filter(b => b.servers.length > 0);

            displayFilters();
            displayBlocks();
            document.getElementById('results').classList.remove('hidden');
        }

        function displayFilters() {
            const ipValues = [...new Set(blocks.map(b => b.byIP))].sort((a, b) => a - b);
            
            let filterHTML = `
                <div class="filter-left">
                    <div class="filter-group">
                        <span class="filter-label">Status:</span>
                        <span class="filter-btn ${currentStatusFilter === 'all' ? 'active' : ''}" onclick="filterByStatus('all')">ALL</span>
                        <span class="filter-btn ${currentStatusFilter === 'good' ? 'active' : ''}" onclick="filterByStatus('good')">GOOD (‚â•70%)</span>
                        <span class="filter-btn ${currentStatusFilter === 'bad' ? 'active' : ''}" onclick="filterByStatus('bad')">BAD (<60%)</span>
                    </div>
                    <div class="ip-filter-group">
                        <span class="filter-label">By IP:</span>
                        <span class="ip-filter-btn ${currentIPFilter === 'all' ? 'active' : ''}" onclick="filterByIP('all')">ALL</span>
            `;
            
            ipValues.forEach(ip => {
                filterHTML += `<span class="ip-filter-btn ${currentIPFilter === ip ? 'active' : ''}" onclick="filterByIP(${ip})">${ip.toLocaleString()}</span>`;
            });
            
            filterHTML += `</div></div>`;
            
            filterHTML += `
                <div class="action-buttons">
                    <button class="btn btn-outline btn-sm" onclick="copySelectedNames()">
                        <i class="fas fa-copy"></i> Copy Names
                    </button>
                    <button class="btn btn-outline btn-sm" onclick="fullReset()">
                        <i class="fas fa-trash"></i> Reset
                    </button>
                </div>
            `;
            
            document.getElementById('filterSection').innerHTML = filterHTML;
        }

        function displayBlocks() {
            const container = document.getElementById('blocksContainer');
            
            let filteredBlocks = blocks;
            if (currentIPFilter !== 'all') {
                filteredBlocks = blocks.filter(b => b.byIP === currentIPFilter);
            }
            
            if (filteredBlocks.length === 0) {
                container.innerHTML = '<div class="no-data"><i class="fas fa-info-circle"></i> No blocks match the selected filters</div>';
                return;
            }
            
            const blocksHTML = filteredBlocks.map((block, index) => {
                let filteredServers = block.servers;
                if (currentStatusFilter === 'good') {
                    filteredServers = block.servers.filter(s => !s.isDown && s.percentage >= 70);
                } else if (currentStatusFilter === 'bad') {
                    filteredServers = block.servers.filter(s => !s.isDown && s.percentage < 60);
                }
                
                if (filteredServers.length === 0) return '';
                
                return `
                    <div class="data-block" id="block-${index}">
                        <div class="block-header">
                            <span class="time-badge"><i class="far fa-clock"></i> ${block.datetime}</span>
                            <span class="ip-badge"><i class="fas fa-bullseye"></i> ${block.byIP.toLocaleString()} per IP</span>
                            <div class="block-actions">
                                <button class="btn btn-outline btn-sm" onclick="copyBlockNames(${index})">
                                    <i class="fas fa-copy"></i> Copy Names
                                </button>
                            </div>
                        </div>
                        <div class="servers-grid">
                            ${filteredServers.map(server => {
                                if (server.isDown) {
                                    return `
                                        <div class="server-card bad">
                                            <div class="server-header">
                                                <span class="server-name"><i class="fas fa-exclamation-triangle"></i> ${server.name}</span>
                                                <span class="server-status bad">DOWN</span>
                                            </div>
                                            <div style="color: #64748b; text-align: center; padding: 10px;">
                                                Server Down
                                            </div>
                                        </div>
                                    `;
                                } else {
                                    return `
                                        <div class="server-card ${server.status}">
                                            <div class="server-header">
                                                <span class="server-name"><i class="fas fa-server"></i> ${server.name}</span>
                                                <span class="server-status ${server.status}">${server.status.toUpperCase()}</span>
                                            </div>
                                            
                                            <div class="stats-row">
                                                <div class="target-box">
                                                    <div class="label">TARGET</div>
                                                    <div class="value">${server.target.toLocaleString()}</div>
                                                </div>
                                                <div class="sent-box">
                                                    <div class="label">SENT</div>
                                                    <div class="value ${server.status}">${server.sent.toLocaleString()}</div>
                                                </div>
                                            </div>
                                            
                                            <div class="progress-bar">
                                                <div class="progress-fill ${server.status}" 
                                                     style="width: ${Math.min(server.percentage, 100)}%"></div>
                                            </div>
                                            <div class="percentage">
                                                ${server.percentage.toFixed(1)}% of target
                                            </div>
                                        </div>
                                    `;
                                }
                            }).join('')}
                        </div>
                    </div>
                `;
            }).join('');
            
            container.innerHTML = blocksHTML;
        }

        function filterByStatus(status) {
            currentStatusFilter = status;
            displayFilters();
            displayBlocks();
        }

        function filterByIP(ip) {
            currentIPFilter = ip;
            displayFilters();
            displayBlocks();
        }

        function resetFilters() {
            currentStatusFilter = 'all';
            currentIPFilter = 'all';
            displayFilters();
            displayBlocks();
        }

        function fullReset() {
            document.getElementById('inputData').value = '';
            
            blocks = [];
            originalInput = '';
            
            currentStatusFilter = 'all';
            currentIPFilter = 'all';
            
            document.getElementById('results').classList.add('hidden');
            
            showNotification('Complete reset - input cleared');
        }

        function copySelectedNames() {
            if (blocks.length === 0) {
                showNotification('No data to copy', 'warning');
                return;
            }

            let filteredBlocks = blocks;
            if (currentIPFilter !== 'all') {
                filteredBlocks = blocks.filter(b => b.byIP === currentIPFilter);
            }

            let allNames = [];
            
            filteredBlocks.forEach(block => {
                let filteredServers = block.servers;
                if (currentStatusFilter === 'good') {
                    filteredServers = block.servers.filter(s => !s.isDown && s.percentage >= 70);
                } else if (currentStatusFilter === 'bad') {
                    filteredServers = block.servers.filter(s => !s.isDown && s.percentage < 60);
                }
                
                filteredServers.forEach(server => {
                    if (!server.isDown) {
                        allNames.push(server.name);
                    }
                });
            });
            
            if (allNames.length === 0) {
                showNotification('No servers match the filters', 'warning');
                return;
            }
            
            const namesText = allNames.join('\n');
            
            navigator.clipboard.writeText(namesText).then(() => {
                showNotification(`${allNames.length} server names copied!`);
            }).catch(() => {
                showNotification('Failed to copy', 'error');
            });
        }

        function copyBlockNames(blockIndex) {
            const block = blocks[blockIndex];
            
            let filteredServers = block.servers;
            if (currentStatusFilter === 'good') {
                filteredServers = block.servers.filter(s => !s.isDown && s.percentage >= 70);
            } else if (currentStatusFilter === 'bad') {
                filteredServers = block.servers.filter(s => !s.isDown && s.percentage < 60);
            }
            
            const names = filteredServers
                .filter(s => !s.isDown)
                .map(s => s.name);
            
            if (names.length === 0) {
                showNotification('No servers in this block', 'warning');
                return;
            }
            
            const namesText = names.join('\n');
            
            navigator.clipboard.writeText(namesText).then(() => {
                const btn = event.target.closest('.block-copy-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                btn.classList.add('success');
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('success');
                }, 2000);
                
                showNotification(`${names.length} server names copied from block!`);
            }).catch(() => {
                showNotification('Failed to copy block names', 'error');
            });
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('copyNotification');
            if (!notification) return;
            notification.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${message}`;
            notification.style.background = type === 'success' ? '#28a745' : type === 'warning' ? '#ffc107' : '#dc3545';
            notification.classList.remove('hidden');
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }

        // ==================== TOOL 2: BY IP EXPLORER (ORIGINAL CODE) ====================
        (function() {
            const rawArea = document.getElementById('rawInput');
            const ipPillsContainer = document.getElementById('ipPillsContainer');
            const resetBtn = document.getElementById('resetSelection');
            const fullResetBtn = document.getElementById('fullResetBtn');
            const resultsContainer = document.getElementById('resultsContainer');
            const selectedIpLabel = document.getElementById('selectedIpLabel');
            const serverCountDisplay = document.getElementById('serverCountDisplay');
            const blockCountSpan = document.getElementById('blockCount');
            const downloadBtn = document.getElementById('downloadTableBtn');
            const toastContainer = document.getElementById('toastContainer');

            let allBlocks = [];
            let uniqueIPs = [];
            let currentFilterIP = null;

            function copyServerNames(blockId, servers) {
                if (!servers || servers.length === 0) {
                    showToast('‚ö†Ô∏è No servers to copy');
                    return;
                }
                
                const textToCopy = servers.join('\n');
                navigator.clipboard.writeText(textToCopy).then(() => {
                    showToast(`‚úÖ Copied ${servers.length} server names`);
                    
                    const copyBtn = document.querySelector(`.copy-btn[data-block-id="${blockId}"]`);
                    if (copyBtn) {
                        const originalText = copyBtn.innerHTML;
                        copyBtn.innerHTML = '<i class="fas fa-check"></i> copied!';
                        copyBtn.classList.add('copied');
                        
                        setTimeout(() => {
                            copyBtn.innerHTML = originalText;
                            copyBtn.classList.remove('copied');
                        }, 1500);
                    }
                }).catch(err => {
                    showToast('‚ùå Failed to copy');
                });
            }

            function parseBlocks(text) {
                const blocks = [];
                
                const rawBlocks = text.split(/(?=Message Send bot|(?<=\n|^)\d+\s+BY\s+IP)/g);
                
                for (let block of rawBlocks) {
                    block = block.trim();
                    if (!block || block.length < 5) continue;

                    let timestamp = 'unknown time';
                    
                    const msgTimestampMatch = block.match(/Message Send bot,\s*\[(.*?)\]/);
                    if (msgTimestampMatch) {
                        timestamp = msgTimestampMatch[1];
                    } else {
                        const timeMatch = block.match(/(\d{2}\/\d{2}\/\d{4}\s+\d{2}:\d{2})|(\d{2}\/\d{2}\/\d{4})|(\d{2}:\d{2}:\d{2})|(\d{2}:\d{2})/);
                        if (timeMatch) {
                            timestamp = timeMatch[0];
                        }
                    }

                    let byIP = null;
                    
                    const byIPMatch = block.match(/By IP:\s*([\d,]+(?:\.\d+)?)/);
                    if (byIPMatch) {
                        byIP = parseFloat(byIPMatch[1].replace(/,/g, ''));
                    } else {
                        const byIpTitleMatch = block.match(/^(\d+)\s+BY\s+IP/im);
                        if (byIpTitleMatch) {
                            byIP = parseFloat(byIpTitleMatch[1]);
                        }
                    }
                    
                    if (!byIP || isNaN(byIP)) continue;

                    const blockServers = [];
                    
                    const serverLines = block.match(/^üü¢\s+([a-zA-Z0-9_]+):/gm);
                    if (serverLines) {
                        for (let line of serverLines) {
                            const match = line.match(/üü¢\s+([a-zA-Z0-9_]+):/);
                            if (match && match[1]) blockServers.push(match[1]);
                        }
                    }
                    
                    const lines = block.split('\n');
                    let inServerSection = false;
                    for (let line of lines) {
                        line = line.trim();
                        if (line.match(/^\d+\s+BY\s+IP$/i)) {
                            inServerSection = true;
                            continue;
                        }
                        if (inServerSection && line.match(/^s[\d_]*cmh6[\d_]*/i)) {
                            blockServers.push(line);
                        } else if (inServerSection && line.length > 0 && !line.match(/^s/)) {
                            inServerSection = false;
                        }
                    }

                    if (blockServers.length === 0) {
                        const genericMatches = block.match(/\b(s[\d_]*cmh6[\d_]*)\b/g);
                        if (genericMatches) {
                            genericMatches.forEach(s => {
                                if (!blockServers.includes(s)) blockServers.push(s);
                            });
                        }
                    }

                    blocks.push({
                        id: `block-${blocks.length}-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
                        byIP: byIP,
                        servers: [...new Set(blockServers)],
                        timestamp: timestamp,
                        serverCount: blockServers.length
                    });
                }
                
                return blocks;
            }

            function refreshData() {
                const rawText = rawArea.value;
                allBlocks = parseBlocks(rawText);
                
                blockCountSpan.innerText = allBlocks.length + (allBlocks.length === 1 ? ' block' : ' blocks');

                const ipSet = new Set(allBlocks.map(b => b.byIP));
                uniqueIPs = Array.from(ipSet).sort((a, b) => a - b);

                renderPills();

                if (currentFilterIP !== null && !ipSet.has(currentFilterIP)) {
                    currentFilterIP = null;
                }

                applyFilter();
            }

            function renderPills() {
                if (uniqueIPs.length === 0) {
                    ipPillsContainer.innerHTML = '<span style="color:#4f6b89; padding:6px;">(no IP limits detected)</span>';
                    return;
                }

                let html = '';
                uniqueIPs.forEach(ip => {
                    const blocksWithIP = allBlocks.filter(b => b.byIP === ip);
                    const totalServers = blocksWithIP.reduce((acc, b) => acc + b.servers.length, 0);
                    const blockCount = blocksWithIP.length;
                    const activeClass = (currentFilterIP === ip) ? 'active' : '';
                    html += `<div class="ip-pill ${activeClass}" data-ip="${ip}">
                                ${ip} <span class="server-count">${blockCount} blocks ¬∑ ${totalServers} servers</span>
                             </div>`;
                });
                ipPillsContainer.innerHTML = html;

                document.querySelectorAll('.ip-pill').forEach(pill => {
                    pill.addEventListener('click', (e) => {
                        const ipVal = parseFloat(pill.dataset.ip);
                        if (isNaN(ipVal)) return;
                        currentFilterIP = ipVal;
                        document.querySelectorAll('.ip-pill').forEach(p => p.classList.remove('active'));
                        pill.classList.add('active');
                        applyFilter();
                    });
                });
            }

            function applyFilter() {
                let filteredBlocks = [];
                if (currentFilterIP === null) {
                    filteredBlocks = allBlocks;
                    selectedIpLabel.innerText = 'üåê all groups';
                } else {
                    filteredBlocks = allBlocks.filter(b => b.byIP === currentFilterIP);
                    selectedIpLabel.innerText = `üîπ By IP = ${currentFilterIP}`;
                }

                const totalServers = filteredBlocks.reduce((acc, b) => acc + b.servers.length, 0);
                serverCountDisplay.innerText = totalServers + (totalServers === 1 ? ' server' : ' servers') + ' across ' + filteredBlocks.length + ' blocks';

                if (filteredBlocks.length === 0) {
                    resultsContainer.innerHTML = `<div class="placeholder-nodata">‚ú® No blocks match</div>`;
                    return;
                }

                let html = '';
                filteredBlocks.forEach((block, idx) => {
                    const ip = block.byIP;
                    const servers = block.servers;
                    const timestamp = block.timestamp;
                    const serverCount = servers.length;
                    const blockId = block.id || `block-${idx}-${Date.now()}`;

                    let serversHtml = '';
                    if (servers.length > 0) {
                        serversHtml = servers.map(s => `<span class="server-chip">${s}</span>`).join('');
                    } else {
                        serversHtml = `<span class="no-servers-chip">‚ö†Ô∏è no server names</span>`;
                    }

                    html += `
                        <div class="block-card">
                            <div class="timestamp-header">
                                <span class="timestamp-badge">‚è±Ô∏è ${timestamp}</span>
                                <span class="server-count-badge">üìä ${serverCount} servers</span>
                            </div>
                            <div class="byip-value">
                                ${ip}
                            </div>
                            <div class="servers-in-card">
                                ${serversHtml}
                                ${servers.length > 0 ? `
                                    <button class="copy-btn" data-block-id="${blockId}" data-servers='${JSON.stringify(servers)}'>
                                        <i class="fas fa-copy"></i> copy all
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    `;
                });

                resultsContainer.innerHTML = html;

                document.querySelectorAll('.copy-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const blockId = btn.dataset.blockId;
                        let servers;
                        
                        try {
                            servers = JSON.parse(btn.dataset.servers);
                        } catch (e) {
                            return;
                        }
                        
                        copyServerNames(blockId, servers);
                    });
                });
            }

            function resetFilter() {
                currentFilterIP = null;
                document.querySelectorAll('.ip-pill').forEach(p => p.classList.remove('active'));
                applyFilter();
                showToast('üåê Showing all groups');
            }

            function fullReset() {
                rawArea.value = '';
                allBlocks = [];
                uniqueIPs = [];
                currentFilterIP = null;
                
                blockCountSpan.innerText = '0 blocks';
                selectedIpLabel.innerText = 'üåê all groups';
                serverCountDisplay.innerText = '0 servers';
                
                renderPills();
                resultsContainer.innerHTML = `<div class="placeholder-nodata">üëÜ paste data, then click any IP pill</div>`;
                
                showToast('‚ú® Reset complete');
            }

            function downloadTable() {
                let blocksToExport = currentFilterIP === null ? allBlocks : allBlocks.filter(b => b.byIP === currentFilterIP);

                if (blocksToExport.length === 0) {
                    showToast('No data to export');
                    return;
                }

                const rows = [['timestamp', 'by_ip', 'server']];
                blocksToExport.forEach(block => {
                    const ip = block.byIP;
                    const timestamp = block.timestamp;
                    if (block.servers.length > 0) {
                        block.servers.forEach(srv => {
                            rows.push([timestamp, ip, srv]);
                        });
                    } else {
                        rows.push([timestamp, ip, '']);
                    }
                });

                let csvContent = rows.map(row => {
                    return row.map(cell => {
                        if (typeof cell === 'string' && (cell.includes(',') || cell.includes('"'))) {
                            return `"${cell.replace(/"/g, '""')}"`;
                        }
                        return cell;
                    }).join(',');
                }).join('\n');

                const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                const filterSuffix = currentFilterIP !== null ? `_ip_${currentFilterIP}` : '_all';
                link.setAttribute('download', `by_ip_blocks${filterSuffix}.csv`);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
                
                showToast('üì• CSV downloaded');
            }

            rawArea.addEventListener('input', refreshData);
            resetBtn.addEventListener('click', resetFilter);
            fullResetBtn.addEventListener('click', fullReset);
            downloadBtn.addEventListener('click', downloadTable);

            window.addEventListener('load', () => {
                if (rawArea.value.trim()) {
                    refreshData();
                }
                resetFilter();
            });
        })();

        // ==================== TOOL 3: EMAIL ERROR PARSER (ORIGINAL CODE) ====================
        let parsedData = {
            errors: new Map(),
            teams: new Map(),
            ipToErrors: new Map(),
            totalIPs: 0,
            totalErrorTypes: 0,
            totalTeams: 0
        };

        function isIPAddress(str) {
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
            return ipPattern.test(str);
        }

        function parseErrors() {
            const input = document.getElementById('inputText').value;
            if (!input.trim()) {
                showToast('Please paste some error log first', 2000, true);
                return;
            }

            showLoading();
            
            parsedData = {
                errors: new Map(),
                teams: new Map(),
                ipToErrors: new Map(),
                totalIPs: 0,
                totalErrorTypes: 0,
                totalTeams: 0
            };

            const lines = input.split('\n');
            let currentTeam = null;
            let currentIPs = [];
            let currentErrorTypes = [];
            let inErrorSection = false;
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (!line) continue;
                
                const teamMatch = line.match(/TEAM:\s*(\w+)/);
                if (teamMatch) {
                    currentTeam = teamMatch[1];
                    if (!parsedData.teams.has(currentTeam)) {
                        parsedData.teams.set(currentTeam, new Map());
                    }
                    continue;
                }
                
                if (line.includes('‚ùóÔ∏èErrors ‚ùóÔ∏è:')) {
                    inErrorSection = true;
                    currentIPs = [];
                    currentErrorTypes = [];
                    continue;
                }
                
                if (inErrorSection) {
                    if (isIPAddress(line)) {
                        currentIPs.push(line);
                        continue;
                    }
                    
                    if (line.startsWith('‚ö†Ô∏è')) {
                        const errorType = line.substring(2).trim();
                        currentErrorTypes.push(errorType);
                        
                        if (!parsedData.errors.has(errorType)) {
                            parsedData.errors.set(errorType, {
                                ips: new Set(),
                                teams: new Set(),
                                occurrences: 0
                            });
                        }
                        
                        if (currentTeam) {
                            parsedData.errors.get(errorType).teams.add(currentTeam);
                        }
                        
                        parsedData.errors.get(errorType).occurrences++;
                        
                        currentIPs.forEach(ip => {
                            parsedData.errors.get(errorType).ips.add(ip);
                            
                            if (!parsedData.ipToErrors.has(ip)) {
                                parsedData.ipToErrors.set(ip, new Set());
                            }
                            parsedData.ipToErrors.get(ip).add(errorType);
                            
                            if (currentTeam) {
                                const teamErrors = parsedData.teams.get(currentTeam);
                                if (!teamErrors.has(errorType)) {
                                    teamErrors.set(errorType, new Set());
                                }
                                teamErrors.get(errorType).add(ip);
                            }
                        });
                        
                        continue;
                    }
                    
                    if (line.includes('Total IPs:')) {
                        inErrorSection = false;
                        currentIPs = [];
                        currentErrorTypes = [];
                    }
                }
            }

            parsedData.totalIPs = parsedData.ipToErrors.size;
            parsedData.totalErrorTypes = parsedData.errors.size;
            parsedData.totalTeams = parsedData.teams.size;

            updateSummaryCards();
            updateErrorTabs();
            
            hideLoading();
            showSections();
            
            if (parsedData.totalErrorTypes > 0) {
                showToast(`‚úÖ Found ${parsedData.totalErrorTypes} error types, ${parsedData.totalIPs} IPs`);
            } else {
                showToast('No errors found in the log', 2000, true);
            }
        }

        function updateSummaryCards() {
            const container = document.getElementById('summaryCards');
            container.style.display = 'grid';
            
            let totalOccurrences = 0;
            for (let [_, errorData] of parsedData.errors) {
                totalOccurrences += errorData.occurrences;
            }
            
            container.innerHTML = `
                <div class="summary-card">
                    <div class="label">Error Types</div>
                    <div class="value">${parsedData.totalErrorTypes}</div>
                </div>
                <div class="summary-card">
                    <div class="label">Unique IPs</div>
                    <div class="value">${parsedData.totalIPs}</div>
                </div>
                <div class="summary-card">
                    <div class="label">Teams Affected</div>
                    <div class="value">${parsedData.totalTeams}</div>
                </div>
                <div class="summary-card">
                    <div class="label">Total Errors</div>
                    <div class="value">${totalOccurrences}</div>
                </div>
            `;
        }

        function updateErrorTabs() {
            const tabsContainer = document.getElementById('errorTabs');
            tabsContainer.innerHTML = '';
            
            document.getElementById('errorCount').textContent = `${parsedData.totalErrorTypes} error${parsedData.totalErrorTypes !== 1 ? 's' : ''}`;
            
            if (parsedData.totalErrorTypes === 0) {
                tabsContainer.innerHTML = '<div style="color: #6c757d; padding: 20px; text-align: center;">No errors detected</div>';
                document.getElementById('errorContent').style.display = 'none';
                return;
            }
            
            const sortedErrors = Array.from(parsedData.errors.entries())
                .sort((a, b) => b[1].ips.size - a[1].ips.size);
            
            for (let [errorType, data] of sortedErrors) {
                const tab = document.createElement('div');
                tab.className = 'error-tab';
                tab.setAttribute('data-error', errorType);
                tab.innerHTML = `
                    ${errorType.length > 30 ? errorType.substring(0, 30) + '...' : errorType}
                    <span class="count">${data.ips.size}</span>
                `;
                tab.onclick = () => showErrorDetails(errorType);
                tabsContainer.appendChild(tab);
            }
            
            if (sortedErrors.length > 0) {
                showErrorDetails(sortedErrors[0][0]);
            }
        }

        function copyErrorIPs(errorType) {
            if (!errorType) {
                showToast('Please select an error type first', 2000, true);
                return;
            }

            const errorData = parsedData.errors.get(errorType);
            if (!errorData || errorData.ips.size === 0) {
                showToast('No IPs to copy', 2000, true);
                return;
            }

            const sortedIPs = Array.from(errorData.ips).sort();
            const textToCopy = sortedIPs.join('\n');
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                showToast(`‚úÖ Copied ${sortedIPs.length} IPs to clipboard`);
            }).catch(err => {
                showToast('‚ùå Failed to copy IPs', 2000, true);
            });
        }

        function showErrorDetails(errorType) {
            const errorData = parsedData.errors.get(errorType);
            if (!errorData) return;

            document.querySelectorAll('.error-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-error') === errorType) {
                    tab.classList.add('active');
                }
            });

            document.getElementById('errorContent').style.display = 'block';

            let ipListHtml = '';
            const sortedIPs = Array.from(errorData.ips).sort();
            
            for (let ip of sortedIPs) {
                const teamsWithIP = [];
                for (let [team, teamErrors] of parsedData.teams) {
                    if (teamErrors.has(errorType) && teamErrors.get(errorType).has(ip)) {
                        teamsWithIP.push(team);
                    }
                }
                
                const allErrorsForIP = parsedData.ipToErrors.get(ip) || new Set();
                const otherErrors = Array.from(allErrorsForIP)
                    .filter(e => e !== errorType)
                    .join(', ');
                
                ipListHtml += `
                    <div class="ip-item">
                        <span class="ip-address">${ip}</span>
                        <div class="ip-teams">
                            ${teamsWithIP.map(team => `<span class="team-badge">Team ${team}</span>`).join('')}
                            ${otherErrors ? `<span class="team-badge" style="background: #e9ecef; color: #495057;" title="Also has: ${otherErrors}">also has other errors</span>` : ''}
                        </div>
                    </div>
                `;
            }

            const content = document.getElementById('errorContent');
            content.innerHTML = `
                <div class="error-stats">
                    <div class="error-stats-grid">
                        <div class="error-stat-item">
                            <div class="error-stat-label">Error Type</div>
                            <div class="error-stat-value">${errorType}</div>
                        </div>
                        <div class="error-stat-item">
                            <div class="error-stat-label">Total IPs</div>
                            <div class="error-stat-value">${errorData.ips.size}</div>
                        </div>
                        <div class="error-stat-item">
                            <div class="error-stat-label">Occurrences</div>
                            <div class="error-stat-value">${errorData.occurrences}</div>
                        </div>
                        <div class="error-stat-item">
                            <div class="error-stat-label">Teams</div>
                            <div class="error-stat-value">${errorData.teams.size}</div>
                        </div>
                    </div>
                </div>
                <div class="ip-list">
                    <div class="ip-list-header">
                        <span>IP Addresses (${errorData.ips.size} total)</span>
                        <button class="copy-ips-btn" onclick="copyErrorIPs('${errorType.replace(/'/g, "\\'")}')">
                            <i class="fas fa-copy"></i> Copy All IPs
                        </button>
                    </div>
                    ${ipListHtml || '<div class="no-data">No IPs found for this error type</div>'}
                </div>
            `;
        }

        function fullReset() {
            document.getElementById('inputText').value = '';
            
            parsedData = {
                errors: new Map(),
                teams: new Map(),
                ipToErrors: new Map(),
                totalIPs: 0,
                totalErrorTypes: 0,
                totalTeams: 0
            };

            document.getElementById('summaryCards').style.display = 'none';
            document.getElementById('errorSelector').style.display = 'none';
            document.getElementById('errorTabs').innerHTML = '';
            document.getElementById('errorContent').style.display = 'none';
            document.getElementById('errorCount').textContent = '0 errors';
            
            showToast('‚ú® Reset complete - everything cleared');
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'block';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        function showSections() {
            document.getElementById('summaryCards').style.display = 'grid';
            document.getElementById('errorSelector').style.display = 'block';
        }

        window.onload = function() {
            if (document.getElementById('inputData').value) {
                parseData();
            }
        };
    </script>
</body>
</html>